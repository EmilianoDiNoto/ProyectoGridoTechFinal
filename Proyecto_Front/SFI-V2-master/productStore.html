<!DOCTYPE html>
<html lang="es">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Production</title>
	<link rel="stylesheet" href="css/sweetalert2.css">
	<link rel="stylesheet" href="css/material.min.css">
	<link rel="stylesheet" href="css/material-design-iconic-font.min.css">
	<link rel="stylesheet" href="css/jquery.mCustomScrollbar.css">
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="css/productionstore.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

	<!-- SweetAlert2 (una sola versión) -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- Tus otros scripts locales -->
	<script src="js/material.min.js"></script>
	<script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
	<script src="js/main.js"></script>
	<script src="js/production_datatable.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">


	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>



	<!-- Chart.js -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="js/jquery-1.11.2.min.js"><\/script>')</script>
	<script src="js/material.min.js"></script>
	<script src="js/sweetalert2.min.js"></script>
	<script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
	<script src="js/main.js"></script>
	<script src="js/menuControl.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

	<!-- BOOTSTRAP -->
	<link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

	<!-- DataTables CSS -->
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.css">
	<link rel="stylesheet" type="text/css"
		href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
	<link rel="stylesheet" type="text/css"
		href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">

	<!-- DataTables JS -->
	<script type="text/javascript" src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.js"></script>
	<script type="text/javascript"
		src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

	<!--Libreria del Calendario Domingo a Sabado-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

</head>

<body>
	<!-- Navbar Superior -->
<nav class="navbar navbar-expand-lg navbar-dark navbar-grido fixed-top">
	<div class="container-fluid">
		<!-- Logo y Nombre -->
		<a class="navbar-brand" href="home1.html">
			<img src="assets/img/logo_negativo-removebg-preview.png" alt="Helacor Logo">
		</a>

		<!-- Botón de hamburguesa para móviles -->
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
			aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>

		<!-- Contenido del menú -->
		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav">
				<!-- Inicio -->
				<li class="nav-item">
					<a class="nav-link" href="home1.html">Inicio</a>
				</li>

				<!-- Dropdown de Producción -->
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownProduccion" role="button"
						data-bs-toggle="dropdown" aria-expanded="false">
						Producción
					</a>
					<ul class="dropdown-menu" aria-labelledby="navbarDropdownProduccion">
						<li><a class="dropdown-item" href="production1.html">Declarar Producción</a></li>
						<li><a class="dropdown-item" href="productionTable.html">Producción Confirmada</a></li>
					</ul>
				</li>

				<!-- Órdenes de Trabajo -->
				<li class="nav-item">
					<a class="nav-link" href="workOders.html">Órdenes de Trabajo</a>
				</li>

				<!-- Almacén -->
				<li class="nav-item">
					<a class="nav-link" href="productStore.html">Almacén</a>
				</li>

				<!-- Incidencias -->
				<li class="nav-item">
					<a class="nav-link" href="incidents.html">Incidencias</a>
				</li>

				<!-- Dropdown de Inventario -->
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdownInventario" role="button"
						data-bs-toggle="dropdown" aria-expanded="false">
						Inventario
					</a>
					<ul class="dropdown-menu" aria-labelledby="navbarDropdownInventario">
						<li><a class="dropdown-item" href="materials.html">Materiales</a></li>
						<li><a class="dropdown-item" href="products.html">Productos</a></li>
					</ul>
				</li>

				<!-- Gestión de Usuarios -->
				<li class="nav-item">
					<a class="nav-link" href="Users_Gestion.html">Gestión de Usuarios</a>
				</li>

				 <!-- Gestión de Usuarios -->
				 <li class="nav-item">
					<a class="nav-link" href="index.html">Cerrar Sesión</a>
				</li>
			</ul>

			<!-- Elementos a la derecha -->
			<div class="navbar-right">
				<!-- Botón de configuración -->
				<button class="settings-btn" title="Configuración">
					<i class="zmdi zmdi-settings"></i>
				</button>

				<!-- Botón de cerrar sesión -->
				<a class="nav-link" href="index.html" title="Cerrar Sesión">
					<i class="zmdi zmdi-power"></i>
				</a>
			</div>
		</div>
	</div>
</nav>
	<section class="full-width main">
		<section>
			<div class="form-container">
				<div class="form-group">
					<label for="fechaDesde">Fecha Desde:</label>
					<input type="date" id="fechaDesde">
				</div>

				<div class="form-group">
					<label for="fechaHasta">Fecha Hasta:</label>
					<input type="date" id="fechaHasta">
				</div>

				<div class="form-group">
					<label for="material">Material:</label>
					<input type="text" id="material" list="materiales" placeholder="Ingrese material">
					<datalist id="materiales">
						<option value="DULCE DE LECHE P/SEMBRAR">
						<option value="TAPA GALLETA SABOR VAINILLA 17 CM">
						<option value="SALSA DULCE SABOR CHOCOLATE">
						<option value="DULCE DE LECHE C/CACAO P/SEMBRAR">
						<option value="GALLETAS MILKA MOUSSE">
						<option value="GALLETA OREO PICADA">
						<option value="PREPARADO ALMIBAR STANDART">
						<option value="HELADO DE CREMA AMERICANA">
						<option value="HELADO DE CHOCOLATE">
						<option value="HELADO DE DULCE DE LECHE">
					</datalist>
				</div>

				<button id="btnBuscar">Buscar</button>
			</div>
		</section>
		<br>
		<section class="container">

			<!-- Sección de Tarjetas -->
			<section>
				<div class="row g-1 d-flex flex-wrap justify-content-center">
					<div class="col-md-2">
						<div class="card text-bg-primary mb-1 mx-1 h-100" onclick="toggleTable('SI')">
							<div class="card-header">STOCK INICIAL</div>
							<div class="card-body">
								<h5 id="totalCantidadSI" class="card-title text-end">0</h5>
								<p class="card-text">Inicial de la semana</p>
							</div>
						</div>
					</div>

					<div class="col-md-2">
						<div class="card text-bg-secondary mb-1 mx-1 h-100" onclick="toggleTable('PEDIDOS')">
							<div class="card-header">PEDIDOS</div>
							<div class="card-body">
								<h5 id="totalCantidad" class="card-title text-end">0</h5>
								<p class="card-text">Ingresados en la semana</p>
							</div>
						</div>
					</div>

					<div class="col-md-2">
						<div class="card text-bg-success mb-1 mx-1 h-100" onclick="toggleTable('DEVOLUCIONES')">
							<div class="card-header">DEVOLUCIONES</div>
							<div class="card-body">
								<h5 id="totalCantidadD" class="card-title text-end">0</h5>
								<p class="card-text">Devoluciones semanal.</p>
							</div>
						</div>
					</div>

					<div class="col-md-2">
						<div class="card text-bg-danger mb-1 mx-1 h-100" onclick="toggleTable('SCRAP')">
							<div class="card-header">SCRAP</div>
							<div class="card-body">
								<h5 id="totalCantidadS" class="card-title text-end">0</h5>
								<p class="card-text">Descartados en la semana.</p>
							</div>
						</div>
					</div>

					<div class="col-md-2">
						<div class="card text-bg-warning mb-1 mx-1 h-100" onclick="toggleTable('STOCKFINAL')">
							<div class="card-header">STOCK FINAL</div>
							<div class="card-body">
								<h5 id="totalCantidadSF" class="card-title text-end">0</h5>
								<p class="card-text">Final de la semana.</p>
							</div>
						</div>
					</div>
				</div>
			</section>

			<!-- Sección de Tablas -->
			<section>
				<div class="row mt-4">
					<div class="col-md-12">
						<div id="tableSI" style="display: none;">
							<h5 class="text-center">STOCK INICIAL</h5>
							<table id="productionStoreTableSI" class="table table-bordered">
								<thead>
									<tr>
										<th>Fecha</th>
										<th>Turno</th>
										<th>Cantidad</th>
										<th>Responsable</th>
									</tr>
								</thead>
								<tbody></tbody>
							</table>
						</div>

						<div id="tablePedidos" style="display: none;">
							<h5 class="text-center">PEDIDOS</h5>
							<table id="productionStoreTable" class="table table-bordered">
								<thead>
									<tr>
										<th>Fecha</th>
										<th>Turno</th>
										<th>Cantidad</th>
										<th>Responsable</th>
									</tr>
								</thead>
								<tbody></tbody>
							</table>
						</div>

						<div id="tableDevoluciones" style="display: none;">
							<h5 class="text-center">DEVOLUCIONES</h5>
							<table id="productionStoreTableD" class="table table-bordered">
								<thead>
									<tr>
										<th>Fecha</th>
										<th>Turno</th>
										<th>Cantidad</th>
										<th>Responsable</th>
									</tr>
								</thead>
								<tbody></tbody>
							</table>
						</div>

						<div id="tableScrap" style="display: none;">
							<h5 class="text-center">SCRAP</h5>
							<table id="productionStoreTableS" class="table table-bordered">
								<thead>
									<tr>
										<th>Fecha</th>
										<th>Turno</th>
										<th>Cantidad</th>
										<th>Responsable</th>
									</tr>
								</thead>
								<tbody></tbody>
							</table>
						</div>

						<div id="tableStockFinal" style="display: none;">
							<h5 class="text-center">STOCK FINAL</h5>
							<table id="productionStoreTableSF" class="table table-bordered">
								<thead>
									<tr>
										<th>Fecha</th>
										<th>Turno</th>
										<th>Cantidad</th>
										<th>Responsable</th>
									</tr>
								</thead>
								<tbody></tbody>
							</table>
						</div>
					</div>
				</div>
			</section>
		</section>

	</section>

	<script>
		//evento para mostrar las tablas
		function toggleTable(cardType) {
			// Ocultar todas las tablas
			document.getElementById('tableSI').style.display = 'none';
			document.getElementById('tablePedidos').style.display = 'none';
			document.getElementById('tableDevoluciones').style.display = 'none';
			document.getElementById('tableScrap').style.display = 'none';
			document.getElementById('tableStockFinal').style.display = 'none';

			// Mostrar la tabla correspondiente
			if (cardType === 'SI') {
				document.getElementById('tableSI').style.display = 'block';
			} else if (cardType === 'PEDIDOS') {
				document.getElementById('tablePedidos').style.display = 'block';
			} else if (cardType === 'DEVOLUCIONES') {
				document.getElementById('tableDevoluciones').style.display = 'block';
			} else if (cardType === 'SCRAP') {
				document.getElementById('tableScrap').style.display = 'block';
			} else if (cardType === 'STOCKFINAL') {
				document.getElementById('tableStockFinal').style.display = 'block';
			}
		}
		


		//CALENDARIO
		document.addEventListener("DOMContentLoaded", function () {
			const fechaDesde = document.getElementById("fechaDesde");
			const fechaHasta = document.getElementById("fechaHasta");

			// Bloquear fechas anteriores en Fecha Hasta
			fechaDesde.addEventListener("change", function () {
				fechaHasta.min = fechaDesde.value;
			});

		});

		//STOCK INICIAL
		$(document).ready(function () {
			var table = $('#productionStoreTableSI').DataTable({
				"processing": true,
				"serverSide": false,
				"ajax": {
					"url": "http://localhost:63152/api/ProductionStore/GetProductionStoreInitial",
					"type": "GET",
					"data": function (d) {
						d.fechaDesde = $('#fechaDesde').val();
						d.material = $('#material').val();
						d.movimiento = "STOCK INICIAL";

						console.log("Datos enviados a la API:", d); // 🔍 Depuración en consola
					},
					"dataSrc": function (json) {
						console.log("Respuesta de la API:", json); // 🔍 Verifica la respuesta de la API

						if (!json || json.length === 0) {
							$("#mensajeSinDatosSI").show(); // Muestra el mensaje si no hay datos
						} else {
							$("#mensajeSinDatosSI").hide(); // Oculta el mensaje si hay datos
						}

						actualizarTotal(json); // Llamar a la función para calcular el total

						return json;
					},
					"error": function (xhr, error, thrown) {
						console.error("Error en la petición AJAX:", xhr.status, xhr.responseText);
					}
				},
				"columns": [
					{
						data: "FECHAMOV",
						className: "text-center",
						render: function (data) {
							let date = new Date(data);
							return date.toLocaleDateString();
						}
					},
					{ "data": "TURNO" },
					{
						"data": "CANTIDAD",
						className: "text-end", // Alinear valores a la derecha
						render: function (data) {
							return new Intl.NumberFormat("es-ES").format(data) + " Kg"; // Agregar separador de miles
						}
					},
					{ "data": "RESPONSABLE" }
				],
				"dom": "t", // Oculta search, show entries, paginación y otros elementos
				"footerCallback": function (row, data, start, end, display) {
					actualizarTotal(data); // También actualiza el total al cargar la tabla
				}
			});

			// Evento para actualizar la tabla con los filtros dinámicos
			$('#btnBuscar').click(function () {
				console.log("Botón de búsqueda presionado 🚀"); // ✅ Depuración
				table.ajax.reload(); // Recargar la tabla con los nuevos filtros
			});

			// Función para calcular y mostrar el total de CANTIDAD
			function actualizarTotal(data) {
				let totalCantidad = data.reduce((sum, item) => sum + (parseFloat(item.CANTIDAD) || 0), 0);
				$("#totalCantidadSI").text(new Intl.NumberFormat("es-ES").format(totalCantidad) + " Kg");
			}
		});

		//PEDIDO
		$(document).ready(function () {
			var table = $('#productionStoreTable').DataTable({
				"processing": true,
				"serverSide": false,
				"ajax": {
					"url": "http://localhost:63152/api/ProductionStore/GetProductionStoreByDateRange",
					"type": "GET",
					"data": function (d) {
						d.fechaDesde = $('#fechaDesde').val();
						d.fechaHasta = $('#fechaHasta').val();
						d.material = $('#material').val();
						d.movimiento = "PEDIDO";

						console.log("Datos enviados a la API:", d); // 🔍 Depuración en consola
					},
					"dataSrc": function (json) {
						console.log("Respuesta de la API:", json); // 🔍 Verifica la respuesta de la API

						if (!json || json.length === 0) {
							$("#mensajeSinDatos").show(); // Muestra el mensaje si no hay datos
						} else {
							$("#mensajeSinDatos").hide(); // Oculta el mensaje si hay datos
						}

						actualizarTotal(json); // Llamar a la función para calcular el total

						return json;
					},
					"error": function (xhr, error, thrown) {
						console.error("Error en la petición AJAX:", xhr.status, xhr.responseText);
					}
				},
				"columns": [
					{
						data: "FECHAMOV",
						className: "text-center",
						render: function (data) {
							let date = new Date(data);
							return date.toLocaleDateString();
						}
					},
					{ "data": "TURNO" },
					{
						"data": "CANTIDAD",
						className: "text-end", // Alinear valores a la derecha
						render: function (data) {
							return new Intl.NumberFormat("es-ES").format(data) + " Kg"; // Agregar separador de miles
						}
					},
					{ "data": "RESPONSABLE" }
				],
				"dom": "t", // Oculta search, show entries, paginación y otros elementos
				"footerCallback": function (row, data, start, end, display) {
					actualizarTotal(data); // También actualiza el total al cargar la tabla
				}
			});

			// Evento para actualizar la tabla con los filtros dinámicos
			$('#btnBuscar').click(function () {
				console.log("Botón de búsqueda presionado 🚀"); // ✅ Depuración
				table.ajax.reload(); // Recargar la tabla con los nuevos filtros
			});

			// Función para calcular y mostrar el total de CANTIDAD
			function actualizarTotal(data) {
				let totalCantidad = data.reduce((sum, item) => sum + (parseFloat(item.CANTIDAD) || 0), 0);
				$("#totalCantidad").text(new Intl.NumberFormat("es-ES").format(totalCantidad) + " Kg");
			}
		});


		// DEVOLUCION
		$(document).ready(function () {
			var table = $('#productionStoreTableD').DataTable({
				"processing": true,
				"serverSide": false,
				"ajax": {
					"url": "http://localhost:63152/api/ProductionStore/GetProductionStoreByDateRange",
					"type": "GET",
					"data": function (d) {
						d.fechaDesde = $('#fechaDesde').val();
						d.fechaHasta = $('#fechaHasta').val();
						d.material = $('#material').val();
						d.movimiento = "DEVOLUCION";

						console.log("Datos enviados a la API:", d); // 🔍 Depuración en consola
					},
					"dataSrc": function (json) {
						console.log("Respuesta de la API:", json); // 🔍 Verifica la respuesta de la API

						if (!json || json.length === 0) {
							$("#mensajeSinDatosD").show(); // Muestra el mensaje si no hay datos
						} else {
							$("#mensajeSinDatosD").hide(); // Oculta el mensaje si hay datos
						}

						actualizarTotal(json); // Llamar a la función para calcular el total

						return json;
					},
					"error": function (xhr, error, thrown) {
						console.error("Error en la petición AJAX:", xhr.status, xhr.responseText);
					}
				},
				"columns": [
					{
						data: "FECHAMOV",
						className: "text-center",
						render: function (data) {
							let date = new Date(data);
							return date.toLocaleDateString();
						}
					},
					{ "data": "TURNO" },
					{
						"data": "CANTIDAD",
						className: "text-end", // Alinear valores a la derecha
						render: function (data) {
							return new Intl.NumberFormat("es-ES").format(data) + " Kg"; // Agregar separador de miles
						}
					},
					{ "data": "RESPONSABLE" }
				],
				"dom": "t", // Oculta search, show entries, paginación y otros elementos
				"footerCallback": function (row, data, start, end, display) {
					actualizarTotal(data); // También actualiza el total al cargar la tabla
				}
			});

			// Evento para actualizar la tabla con los filtros dinámicos
			$('#btnBuscar').click(function () {
				console.log("Botón de búsqueda presionado 🚀"); // ✅ Depuración
				table.ajax.reload(); // Recargar la tabla con los nuevos filtros
			});

			// Función para calcular y mostrar el total de CANTIDAD
			function actualizarTotal(data) {
				let totalCantidad = data.reduce((sum, item) => sum + (parseFloat(item.CANTIDAD) || 0), 0);
				$("#totalCantidadD").text(new Intl.NumberFormat("es-ES").format(totalCantidad) + " Kg");
			}
		});


		// SCRAP
		$(document).ready(function () {
			var table = $('#productionStoreTableS').DataTable({
				"processing": true,
				"serverSide": false,
				"ajax": {
					"url": "http://localhost:63152/api/ProductionStore/GetProductionStoreByDateRange",
					"type": "GET",
					"data": function (d) {
						d.fechaDesde = $('#fechaDesde').val();
						d.fechaHasta = $('#fechaHasta').val();
						d.material = $('#material').val();
						d.movimiento = "SCRAP";

						console.log("Datos enviados a la API:", d); // 🔍 Depuración en consola
					},
					"dataSrc": function (json) {
						console.log("Respuesta de la API:", json); // 🔍 Verifica la respuesta de la API

						if (!json || json.length === 0) {
							$("#mensajeSinDatosS").show(); // Muestra el mensaje si no hay datos
						} else {
							$("#mensajeSinDatosS").hide(); // Oculta el mensaje si hay datos
						}

						actualizarTotal(json); // Llamar a la función para calcular el total

						return json;
					},
					"error": function (xhr, error, thrown) {
						console.error("Error en la petición AJAX:", xhr.status, xhr.responseText);
					}
				},
				"columns": [
					{
						data: "FECHAMOV",
						className: "text-center",
						render: function (data) {
							let date = new Date(data);
							return date.toLocaleDateString();
						}
					},
					{ "data": "TURNO" },
					{
						"data": "CANTIDAD",
						className: "text-end", // Alinear valores a la derecha
						render: function (data) {
							return new Intl.NumberFormat("es-ES").format(data) + " Kg"; // Agregar separador de miles
						}
					},
					{ "data": "RESPONSABLE" }
				],
				"dom": "t", // Oculta search, show entries, paginación y otros elementos
				"footerCallback": function (row, data, start, end, display) {
					actualizarTotal(data); // También actualiza el total al cargar la tabla
				}
			});

			// Evento para actualizar la tabla con los filtros dinámicos
			$('#btnBuscar').click(function () {
				console.log("Botón de búsqueda presionado 🚀"); // ✅ Depuración
				table.ajax.reload(); // Recargar la tabla con los nuevos filtros
			});

			// Función para calcular y mostrar el total de CANTIDAD
			function actualizarTotal(data) {
				let totalCantidad = data.reduce((sum, item) => sum + (parseFloat(item.CANTIDAD) || 0), 0);
				$("#totalCantidadS").text(new Intl.NumberFormat("es-ES").format(totalCantidad) + " Kg");
			}
		});

		//STOCK FINAL
		$(document).ready(function () {
			var table = $('#productionStoreTableSF').DataTable({
				"processing": true,
				"serverSide": false,
				"ajax": {
					"url": "http://localhost:63152/api/ProductionStore/GetProductionStoreFinal",
					"type": "GET",
					"data": function (d) {
						d.fechaHasta = $('#fechaHasta').val();
						d.material = $('#material').val();
						d.movimiento = "STOCK FINAL";

						console.log("Datos enviados a la API:", d); // 🔍 Depuración en consola
					},
					"dataSrc": function (json) {
						console.log("Respuesta de la API:", json); // 🔍 Verifica la respuesta de la API

						if (!json || json.length === 0) {
							$("#mensajeSinDatosSF").show(); // Muestra el mensaje si no hay datos
						} else {
							$("#mensajeSinDatosSF").hide(); // Oculta el mensaje si hay datos
						}

						actualizarTotal(json); // Llamar a la función para calcular el total

						return json;
					},
					"error": function (xhr, error, thrown) {
						console.error("Error en la petición AJAX:", xhr.status, xhr.responseText);
					}
				},
				"columns": [
					{
						data: "FECHAMOV",
						className: "text-center",
						render: function (data) {
							let date = new Date(data);
							return date.toLocaleDateString();
						}
					},
					{ "data": "TURNO" },
					{
						"data": "CANTIDAD",
						className: "text-end", // Alinear valores a la derecha
						render: function (data) {
							return new Intl.NumberFormat("es-ES").format(data) + " Kg"; // Agregar separador de miles
						}
					},
					{ "data": "RESPONSABLE" }
				],
				"dom": "t", // Oculta search, show entries, paginación y otros elementos
				"footerCallback": function (row, data, start, end, display) {
					actualizarTotal(data); // También actualiza el total al cargar la tabla
				}
			});

			// Evento para actualizar la tabla con los filtros dinámicos
			$('#btnBuscar').click(function () {
				console.log("Botón de búsqueda presionado 🚀"); // ✅ Depuración
				table.ajax.reload(); // Recargar la tabla con los nuevos filtros
			});

			// Función para calcular y mostrar el total de CANTIDAD
			function actualizarTotal(data) {
				let totalCantidad = data.reduce((sum, item) => sum + (parseFloat(item.CANTIDAD) || 0), 0);
				$("#totalCantidadSF").text(new Intl.NumberFormat("es-ES").format(totalCantidad) + " Kg");
			}
		});

		

	</script>

	<!-- Librerías necesarias -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- CSS de DataTables -->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">

	<!-- JS de DataTables -->
	<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>

	<!-- Archivo JavaScript separado -->
	<script src="js/production1.js"></script>

</body>

</html>